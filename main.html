<!DOCTYPE html>
    <html>
        <head>
            <style>
                html {
                background-color: rgb(0, 0, 0);
                }
            
                #text {
                font-family: monospace;
                color:rgb(255, 255, 255);
                }
                
                #form {
                    font-family: monospace;
                    background-color: rgb(0, 0, 0);
                    color:rgb(255, 255, 255);
                }
            </style>
        </head>
        <body>
            <form id="input form">
                <input type= "text" size= "160" id= 'form' autocomplete="off">
            </form>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js">     //the jQuery library
            
            </script>

            <p id="text">
                <br>
            </p>

            <script id="files,msg,lib">
                var files = {   //the files object
                    txt: {      //text files
                        tmp: "",
                        notes: ["0: entrie (/end)"]
                    },
                    js: {       //javascript files
                        tmp: ""
                    },
                    json: {     //json files
                        tmp: ""
                    }
                }

                var msg = {
                    err: [      //the error messages
                    "error: file not found", 
                    "error: cannot open that file type in that way", 
                    "error: that file type doesn't exist",
                    "error: that file type alredy exists",
                    "error: no notes.txt found, cannot write notes"
                    ]
                }

                var lib = {
                    log: function(log, file) {     //the console output shorthand for inner .js files
                        $('#text').prepend(file+' >> '+log+'<br>')
                    }, 
                    cmlog: function(log) {      //the console output shorthand for the system
                        $('#text').prepend(log+'<br>');
                    },
                    usrLog: function(log) {     //the console output shorthand for user output
                        $('#text').prepend('<br>');
                        $('#text').prepend('>>>'+log+'<br>');
                    }
                }

            </script>

            <script>
                var setFormVal = {
                    val: '',
                }
                var vars = {
                    game: {
                        mover: {
                            isRunning: 0,
                            playerX: 2,
                            playerY: 2,
                            drawFeild: function() {
                                var playerX = vars.game.mover.playerX;  //player X
                                var playerY = vars.game.mover.playerY;  //player Y
                                var output = '';    //output
                                for (var i = 0; i < 10; i++) {      //cycles through rows
                                    if (playerY == i) {
                                        for (var l = 0; l < 10; l++) {      //cycles through segments of the row of playerY
                                            if (playerX == l) {     //adds an X to playerX of that row
                                                output += "X";
                                            } else {    //adds O otherwise
                                                output += "O";
                                            }
                                        }
                                        lib.cmlog(output);  //output row
                                    } else {    //if playerY is not in row, output an empty one
                                        lib.cmlog('OOOOOOOOOO');
                                    }
                                }
                            },
                            move: function(direction) {
                                var playerX = vars.game.mover.playerX;  //player X
                                var playerY = vars.game.mover.playerY;  //player Y

                                if (direction == 'w') {
                                    vars.game.mover.playerY++;
                                } else if (direction == 'a') {
                                    vars.game.mover.playerX--;
                                } else if (direction == 's') {
                                    vars.game.mover.playerY--;
                                } else if (direction == 'd') {
                                    vars.game.mover.playerX++;
                                }
                                vars.game.mover.drawFeild();
                            }
                        },
                        any: {
                            draw: function(size, x, y) {
                                for (var i = 0; i < size; i++) {     //cycles through rows
                                    var output = '';
                                    if (y == i) {
                                        for (var l = 0; l < size; l++) {      //cycles through segments of the row of playerY
                                            if (x == l) {     //adds an X to playerX of that row
                                                output += "-";
                                            } else {    //adds O otherwise
                                                output += "0";
                                            }
                                        }
                                        lib.cmlog(output);  //output row
                                    } else {    //if playerY is not in row, output an empty one
                                        for (var x = 0; x < size; x++) {
                                            output += "-";
                                        }
                                        lib.cmlog(output);
                                    }
                                }
                            }
                        }
                    }
                }
            </script>

            <script id="commands">
                var cm = {
                    test: function(a) {     //for testing
                        lib.cmlog("all, good!");
                        lib.cmlog("argument is: "+a);
                        setTimeout(function(){ lib.cmlog(a); }, 300);
                    },
                    console: {
                        clear: function() {     //clears the output console
                            $('#text').html('<br>');
                        }
                    },
                    file: {
                        set: function(nameAndType, contents) {      //sets a files contents
                            var nmTyp = nameAndType.split('.');     //splits the _._ into [_, _]
                            var name = nmTyp[0];       //gets the name of the file
                            var type = nmTyp[1];        //gets the type of file
                            var Type = files[type];     //gets the type object
                            if (Type == undefined) {
                                lib.cmlog(msg.err[2]);  //if the file type is not txt, js, json; send error 2
                            } else {
                                if (Type[name] == undefined) {
                                    Type[name] = contents;      //if that file dosent exist, make it
                                    lib.cmlog('file: '+nameAndType+' was created');
                                } else {
                                    Type[name] = contents;      //if that file exists, replace it
                                    lib.cmlog('file: '+nameAndType+' was replaced');
                                }
                            }
                        },
                        read: function(nameAndType) {       //reads file contents
                                var nmTyp = nameAndType.split('.');     //splits the _._ into [_, _]
                                var name = nmTyp[0];        //gets the name of the file
                                var type = nmTyp[1];        //gets the type of file
                                var Type = files[type];     //gets the type object
                                if (Type[name] == undefined) {
                                    lib.cmlog(msg.err[0]);      //if that file dosent exist, send error 0
                                } else {
                                    lib.cmlog(nameAndType+': '+Type[name]);     //ouput the contents of the file
                                }
                        },
                        delete: function(nameAndType) {     //deletes a file
                                var nmTyp = nameAndType.split('.');     //splits the _._ into [_, _]
                                var name = nmTyp[0];        //gets the name of the file
                                var type = nmTyp[1];        //gets the type of file
                                var Type = files[type];     //gets the type object
                                if (Type[name] == undefined) {
                                    lib.cmlog(msg.err[0]);      //if that file dosent exist, send error 0
                                } else {
                                    delete Type[name];      //delete that file
                                    lib.cmlog('file: '+nameAndType+' wes deleted');
                                }
                        },
                        run: function(nameAndType) {    //runs .js files
                            var nmTyp = nameAndType.split('.');
                            var name = nmTyp[0];
                            var type = nmTyp[1];
                            var Type = files[type];
                            var func = Type[name];
                            if (Type[name] == undefined) {
                                lib.cmlog(msg.err[0]);
                            } else if (type == "js") {
                                    eval(func);
                                } else {
                                    lib.cmlog(msg.err[1]);
                                }
                        },
                        add: {
                            fileType: function(type) {          //WIP--------------------------------
                                Type = files[type];                     //you will be able to add file types
                                if (Type == undefined) {
                                    files[type] = {};
                                    Type = files[type];
                                    Type.tmp = "";
                                } else {
                                    lib.cmlog(msg.err[3]);
                                }
                            }                                   //WIP---------------------------------
                        },
                        list: {
                            all: function() {   //lists the files object as a string
                                lib.cmlog(JSON.stringify(files));
                            },
                            txt: function() {   //lists the objects under txt as a string
                                lib.cmlog(JSON.stringify(files.txt));
                            },
                            js: function() {    //lists the objects under js as a string
                                lib.cmlog(JSON.stringify(files.js));
                            },
                            json: function() {  //lists the objects under json as a string
                                lib.cmlog(JSON.stringify(filesjson));
                            }
                        }
                    },
                    msg: {
                        encode: function(msg) {     //encodes a message from english to KIHU Encoding
                                //the array that assigns all elegable characters a 2-digit number
                            var enc = [null,null,null,null,null,null,null,null,null,null,'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z',' ',',','.','/','0','1','2','3','4','5','6','7','8','9'];
                            var msgA = msg.split('');   ////makes an array of every character in the input message
                            var msgEnc = "";    //will be the encoded message
                            for (var i = 0; i< msgA.length; i++) {
                                msgEnc = msgEnc + enc.indexOf(msgA[i]); //adds the next encoded character to msgEnc
                            }
                            lib.cmlog("^^^ Encoded message ^^^"); //outputs: ^^^ Encoded message ^^^
                            lib.cmlog(msgEnc);  //outputs the encoded message
                        },
                        decode: function(msgEnc) {  //decodes a message from KIHU Encoding to english
                                //the array that assigns all elegable characters a 2-digit number
                            var enc = [null,null,null,null,null,null,null,null,null,null,'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z',' ',',','.','/','0','1','2','3','4','5','6','7','8','9'];
                            var msgA = msgEnc.split('');    //makes an array of every character in the encoded message
                            var msgB = [];  //will be an array of every 2-digit identifier number
                            var msg = "";   //will be the decoded message
                            for (var i = 0; i < msgA.length; i+= 2) {
                                msgB.push(msgA[i+0] + msgA[i+1]);   //makes msgB into an array of the 2-digit codes
                            };
                            for (var j = 0; j< msgB.length; j++) {
                                msg = msg + enc[msgB[j]];    //adds the next decoded character of msgB
                            };
                            lib.cmlog("^^^ Decoded message ^^^");   //outputs: ^^^ Decoded message ^^^
                            lib.cmlog(msg);    //outputs the decoded message
                        }
                    },
                    note: {
                        write: function(note) {     //makes a note
                            if (files.txt.notes == undefined) {
                                lib.cmlog(msg.err[4]);
                            } else {
                                files.txt.notes.push(' '+files.txt.notes.length+': '+note + ' (/end)');
                                lib.cmlog('\"'+note+'\" added to entrie: '+(files.txt.notes.length - 1)+' of notes.txt');
                            }
                        },
                        read: function(index) {     //outputs the contents of one or all the notes
                            if (index == "all") {
                                lib.cmlog(files.txt.notes);
                                lib.cmlog('notes');
                            } else {
                                lib.cmlog(files.txt.notes[index]);
                                lib.cmlog('notes');
                            }
                        },
                        delete: function(index) {   //deletes one or all the notes
                            if (index == "all") {
                                files.txt.notes = ["0: entrie (/end)"];
                                lib.cmlog('cleared notes');
                            } else {
                                files.txt.notes.splice(index, 1);
                                lib.cmlog("deleted entire: "+index);
                            }
                        }
                    },
                    game: {
                        mover: {
                            run: function() {
                                vars.game.mover.isRunning = 1;
                                vars.game.mover.drawFeild();
                            },
                            play: function(direction) {
                                if (vars.game.mover.isRunning == 1) {
                                    vars.game.mover.move(direction);
                                    setFormVal.val = 'game.mover.play~';
                                }
                            },
                            rules: function() {
                                lib.cmlog('')
                            },
                            end: function() {
                                vars.game.mover.isRunning = 0;
                            }
                        }
                    },
                    code: {
                        startup: function() {
                            var impr = [
                                'var d = ' + Math.random() + ';',
                                'var a = ' + Math.random() + ';',
                                'var mitr = ' + Math.random() + ';',
                                'var hos = ' + Math.random() + ';',
                                'for (i = 0; i < 50; i++) {',
                                'for (l = 0; l < 58; l++) {',
                                '};',
                                'while (a = true) {',
                                'dm.maga();',
                                '$mmd[arft];',
                                'fnc("function = null");',
                                '#binDsoRt[l].scndry(hoft);',
                                'addNot@svn.cde("6&7-503");',
                                'lst.path(thsCmp/usr/andek/fle/set/git/github/repos/voww/gotm/fool.txt)',
                                'actu.at(<mrr/vr>alwo/dalk.brn(awk)</ale>)'
                            ];
                            for (var z = 0; z < 10; z++) {
                                for (var i = 0; i < 10; i++) {
                                    setTimeout(function(i) {
                                        lib.cmlog(impr[Math.floor(Math.random()*impr.length)]);
                                    }, 50*i);
                                };
                            };
                            setTimeout(function(){cm.code.tree();}, 600);
                        },
                        tree: function() {
                            var impr = [
                                "|",
                                "|__brnch/ff/hfd/zipe",
                                "|",
                                "|____setCons/godle/cloe",
                                "|___fod.dia/sope/arod/noni/ddo",
                                "|",
                                "|______vids/df/gfs/as",
                                "|___sfb/izc/ggh/qrw/mmm.nui",
                                "|",
                                "|________gs/adf/rnccx/gollw/zrq",
                                "|___________________________vsdz/domoe/sfd.txi",
                                "|",
                                "|_________________________rwe/lndf/tuy/vv.gol"
                            ];
                            for (var z = 0; z < 10; z++) {
                                for (var i = 0; i < 10; i++) {
                                    setTimeout(function(i) {
                                        lib.cmlog(impr[Math.floor(Math.random()*impr.length)]);
                                    }, 50*i);
                                };
                            };
                            setTimeout(function() {cm.console.clear();}, 1000);
                                setTimeout(function() {lib.cmlog('Startup complete.');}, 1100)
                        }
                    },
                    story: {
                        launch: function() {
                            setTimeout(function() {lib.cmlog('t-5');}, 1000);
                            setTimeout(function() {lib.cmlog('t-4');}, 2000);
                            setTimeout(function() {lib.cmlog('t-3');}, 3000);
                            setTimeout(function() {lib.cmlog('t-2');}, 4000);
                            setTimeout(function() {lib.cmlog('t-1');}, 5000);
                            setTimeout(function() {lib.cmlog('LAUNCH');}, 6000);
                        }
                    }
                };

                cm.code.startup();
            </script>

            <script id="calling functions">
                $("form").on("submit", function(event) {
                    event.preventDefault();     //stops the form from reloading the page, I think

                    var $input = $(this).find('input');     //step 1 of getting the form input
                    var input = $input.val();       //step 2 of getting the form input

                    lib.usrLog(input);      //initially outputting the user's input to keep track of what happened later
                    var prts = input.split("~");      //splits the user's input from functin called to arguments
                    var parts = prts[0].split('.');     //splits the first part of the input(the function naming part)
                    var fn = null;      //fn will be called later, as the function

                    for (var i = 0; i< parts.length ; i++) {
                        if (fn == null) {
                            fn = cm[parts[i]];      //if this is the first loop, build the first part of the fn function
                        } else {
                            fn = fn[parts[i]];      //if this is not the first loop, build on top of the fn function
                        }
                    };

                    if (prts[1] == undefined) {
                        fn();       //if there are no arguments, call fn without any
                    } else {
                        var arguments = prts[1].split('//');   //if there are args, split them on ' & '
                        if (arguments.length == 1) {
                            fn(arguments[0]);       //if there is one arg, call fn with one
                        } else if (arguments.length == 2) {
                            fn(arguments[0], arguments[1]);     //if there are 2 args, call fn with 2
                        }
                    }
                    $('#form').val(setFormVal.val);
                    setFormVal.val = ''
                });
            </script>
        </body>
    </html>